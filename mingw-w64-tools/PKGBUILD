# Maintainer: rubenvb vanboxem <dottie> ruben <attie> gmail <dottie> com
pkgname=mingw-w64-tools
pkgver=3.0.0
pkgrel=2
pkgdesc='MinGW-w64 gendef, genidl, genpeimg, and widl tools.'
arch=('i686' 'x86_64')
url='http://mingw-w64.sourceforge.net'
license=('custom')
groups=('mingw-w64')
depends=()
makedepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=('!libtool' '!emptydirs')
source=(http://sourceforge.net/projects/mingw-w64/files/mingw-w64/mingw-w64-release/mingw-w64-v${pkgver}.tar.bz2)
md5sums=('22b0030702fe00927daf1ae6ddfb526e')

build() {
  cd ${srcdir}
  msg "Building MinGW-w64-tools"
  mkdir -p ${srcdir}/gendef-build && cd ${srcdir}/gendef-build
    ${srcdir}/mingw-w64-v${pkgver}/mingw-w64-tools/gendef/configure --prefix=/usr
    make
  mkdir -p ${srcdir}/genidl-build && cd ${srcdir}/genidl-build
    ${srcdir}/mingw-w64-v${pkgver}/mingw-w64-tools/genidl/configure --prefix=/usr
    make
  
  mkdir -p ${srcdir}/genpeimg-build && cd ${srcdir}/genpeimg-build
    ${srcdir}/mingw-w64-v${pkgver}/mingw-w64-tools/genpeimg/configure --prefix=/usr
    make
  
  mkdir -p ${srcdir}/widl-build && cd ${srcdir}/widl-build
    ${srcdir}/mingw-w64-v${pkgver}/mingw-w64-tools/widl/configure --prefix=/usr
    make
}

package() {
  msg "Installing MinGW-w64-tools"
  cd ${srcdir}/gendef-build
  make DESTDIR=${pkgdir} install
  cd ${srcdir}/genidl-build
  make DESTDIR=${pkgdir} install
  cd ${srcdir}/genpeimg-build
  make DESTDIR=${pkgdir} install
  cd ${srcdir}/widl-build
  make DESTDIR=${pkgdir} install
  msg "Installing licenses"
  install -Dm644 ${srcdir}/mingw-w64-v${pkgver}/mingw-w64-tools/gendef/COPYING ${pkgdir}/usr/share/licenses/${pkgname}/COPYING.gendef
  install -Dm644 ${srcdir}/mingw-w64-v${pkgver}/mingw-w64-tools/genidl/COPYING ${pkgdir}/usr/share/licenses/${pkgname}/COPYING.genidl
  install -Dm644 ${srcdir}/mingw-w64-v${pkgver}/mingw-w64-tools/gendpeimg/COPYING ${pkgdir}/usr/share/licenses/${pkgname}/COPYING.genpeimg
  install -Dm644 ${srcdir}/mingw-w64-v${pkgver}/mingw-w64-tools/widl/COPYING ${pkgdir}/usr/share/licenses/${pkgname}/COPYING.widl
}

